{# app/templates/dashboard.html (DESIGN AMÉLIORÉ v2) #}
{% extends "base.html" %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
<div class="container mt-4"> {# Ajout conteneur + marge #}
    <h1 class="mb-4">{{ _('Bienvenue sur votre tableau de bord, %(username)s !', username=current_user.full_name) }}</h1>

    <div class="alert alert-success fs-5 mb-4 shadow-sm"> {# Ajout ombre légère #}
       <i class="bi bi-wallet2"></i> {{ _('Votre Solde Actuel:') }}
       <strong class="mx-2">$ {{ "%.2f"|format(current_user.balance) }}</strong> {# Formatage à 2 décimales #}
       <a href="{{ url_for('main.withdraw') }}" class="btn btn-sm btn-outline-success ms-3">{{ _('Demander un retrait') }}</a>
    </div>

    <div class="row g-4"> {# Augmentation de l'espacement entre cartes (g-4) #}
        <div class="col-md-6 col-lg-4">
            <div class="card h-100 shadow-sm text-center border-0"> {# Bordure enlevée #}
                <div class="card-body d-flex flex-column justify-content-center"> {# Centre verticalement #}
                    <i class="bi bi-list-task fs-1 text-primary mb-3"></i>
                    <h5 class="card-title">{{ _('Tâches Disponibles') }}</h5>
                    <p class="card-text flex-grow-1"><small>{{ _('Voir les tâches qui vous attendent.') }}</small></p>
                    <a href="{{ url_for('main.available_tasks') }}" class="btn btn-primary mt-auto">{{ _('Voir les tâches') }}</a> {# mt-auto pousse en bas #}
                </div>
            </div>
        </div>
        <div class="col-md-6 col-lg-4">
            <div class="card h-100 shadow-sm text-center border-0">
                 <div class="card-body d-flex flex-column justify-content-center">
                    <i class="bi bi-check2-square fs-1 text-success mb-3"></i>
                    <h5 class="card-title">{{ _('Tâches Accomplies') }}</h5>
                    <p class="card-text flex-grow-1"><small>{{ _('Consultez l\'historique de vos gains.') }}</small></p>
                    <a href="{{ url_for('main.completed_tasks') }}" class="btn btn-success mt-auto">{{ _('Voir l\'historique') }}</a>
                </div>
            </div>
        </div>
         <div class="col-md-6 col-lg-4">
            <div class="card h-100 shadow-sm text-center border-0 bg-light">
                 <div class="card-body d-flex flex-column justify-content-center">
                    <i class="bi bi-person-plus-fill fs-1 text-info mb-3"></i>
                    <h5 class="card-title">{{ _('Inviter des Amis') }}</h5>
                     <p class="card-text mb-1"><small>{{ _('Votre Code:') }}</small><br><strong class="fs-5">{{ current_user.referral_code }}</strong></p>
                     {% set reg_link = url_for('auth.register', ref=current_user.referral_code, _external=True) %}
                     <button class="btn btn-sm btn-outline-info mt-2" type="button" onclick="copyToClipboard('{{ reg_link }}')" title="{{ _('Copier le lien') }}">
                         <i class="bi bi-clipboard"></i> {{ _('Copier Lien d\'Invitation') }}
                     </button>
                </div>
            </div>
        </div>
    </div>

    <div class="alert alert-warning mt-5" role="alert">
      <h4 class="alert-heading">{{ _('Important !') }}</h4> <p>{{ config.FRAUD_WARNING }}</p> <hr> <p class="mb-0">{{ _('Assurez-vous de bien lire les instructions avant de marquer une tâche comme accomplie.') }}</p>
    </div>
</div> {# Fin container #}
{% endblock %}

{% block scripts %} {{ super() }} <script> function copyToClipboard(text) { navigator.clipboard.writeText(text).then(function() { alert("{{ _('Lien copié dans le presse-papiers !') }}"); }, function(err) { alert("{{ _('Erreur lors de la copie du lien : ') }}" + err); }); } </script> {% endblock %}